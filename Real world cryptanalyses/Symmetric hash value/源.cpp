#include <iostream>
#include <stdio.h>
#include <stdlib.h>
#include "meow_hash_x64_aesni.h"

using namespace std;
const char* MESSAGE = "helloworldabcdefhelloworldabcdefhelloworldabcdefhelloworldabcdef" ;
const int Len =64;
//The key is derived from a result of a reversibility attack
meow_u8 Key[128] =
{
	0x67,0x4D,0xD7,0x3B,0x56,0x97,0x22,0x67,0xE7,0x32,0x74,0xB6,0x0C,0x28,0x13,0x22,
	0xC2,0xA8,0x3A,0x34,0xDD,0xDC,0x8D,0x68,0xE1,0x68,0xD6,0xE5,0xDB,0x87,0xF2,0x28,
	0xB2,0x13,0x6F,0xA4,0x46,0x6A,0xA9,0x50,0xAB,0xDD,0x5C,0x79,0xD6,0x35,0xDB,0xDD,
	0x52,0x27,0x36,0x0A,0x94,0x3D,0x75,0x3E,0xED,0xED,0xE9,0xED,0x86,0xF0,0xF4,0xA1,
	0x81,0xCE,0x24,0x91,0xED,0x06,0x7A,0x54,0x19,0x9C,0x39,0xAA,0x84,0xDE,0x6E,0x35,
	0x6A,0x99,0x79,0x6A,0x05,0x26,0x22,0xC8,0x63,0x8F,0xC6,0x9F,0xB1,0xD3,0x22,0x52,
	0xDB,0xAA,0x5C,0xCB,0x46,0x89,0xCD,0xCD,0xF5,0xB5,0xD6,0x08,0xDD,0x09,0x5D,0x0E,
	0x73,0x84,0xB2,0xD5,0xD5,0xFD,0x4E,0xBD,0xC9,0xB5,0xA4,0x9E,0xAF,0xF0,0x97,0x1F
};
void Print(meow_u128 Hash) 
{
	printf("%08X %08X %08X %08X\n",
		MeowU32From(Hash, 3),
		MeowU32From(Hash, 2),
		MeowU32From(Hash, 1),
		MeowU32From(Hash, 0));
}
int main() 
{
	char* Message = new char[Len + 1];
	memset(Message, 0, Len + 1);
	memcpy(Message, MESSAGE, Len);
	cout << "Message: " << Message << endl;
	Invertibility(Len, Message);
	meow_u128 Hash = MeowHash(Key, Len, Message);
	cout << "Hash:" << endl;
	Print(Hash);
	cout <<endl;
	delete[] Message;
	return 0;
}